/* =================================================================== */
/* main.css — 统一浅色主题 + 通用布局 + Element Plus 适配               */
/* =================================================================== */

/* 先引入基础样式（变量/排版/组件统一） */
@import './base.css';

/* =================================================================== */
/* 主题色板与基础变量                                                   */
/* =================================================================== */

/* Vite/Vue 官方色板（供语义变量/主题引用） */
:root {
  --vt-c-white: #ffffff;
  --vt-c-white-soft: #f8f8f8;
  --vt-c-white-mute: #f2f2f2;

  --vt-c-black: #181818;
  --vt-c-black-soft: #222222;
  --vt-c-black-mute: #282828;

  --vt-c-indigo: #2c3e50;

  --vt-c-divider-light-1: rgba(60, 60, 60, 0.29);
  --vt-c-divider-light-2: rgba(60, 60, 60, 0.12);
  --vt-c-divider-dark-1: rgba(84, 84, 84, 0.65);
  --vt-c-divider-dark-2: rgba(84, 84, 84, 0.48);

  --vt-c-text-light-1: var(--vt-c-indigo);
  --vt-c-text-light-2: rgba(60, 60, 60, 0.66);
  --vt-c-text-dark-1: var(--vt-c-white);
  --vt-c-text-dark-2: rgba(235, 235, 235, 0.86);
}

/* === 主题&边框变量（默认：Ocean） === */
:root {
  /* 品牌主色阶 */
  --brand-50:  #eff6ff;
  --brand-100: #dbeafe;
  --brand-200: #bfdbfe;
  --brand-400: #60a5fa;
  --brand-600: #2563eb;
  --brand-700: #1d4ed8;

  --brand:        var(--brand-600);
  --brand-weak:   var(--brand-100);
  --brand-strong: var(--brand-700);

  /* Header 渐变 */
  --header-grad-a: #6dd5ed;
  --header-grad-b: #2193b0;

  /* 面板背景 */
  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;

  /* 边框/圆角/阴影（全局可控） */
  --border-color: #e5e7eb;
  --border-style: solid;     /* solid | dashed | dotted | none */
  --border-width: 1px;
  --radius-md: 12px;
  --radius-xl: 16px;
  --radius-2xl: 20px;

  --shadow-soft: 0 6px 16px rgba(0,0,0,.08);
  --shadow:      0 10px 30px rgba(0,0,0,.12);
}

/* 主题：Slate（中性灰蓝） */
.theme-slate {
  --brand-50:  #eef2ff;
  --brand-100: #e2e8f0;
  --brand-400: #94a3b8;
  --brand-600: #475569;
  --brand-700: #334155;

  --brand: var(--brand-600);
  --brand-weak: var(--brand-100);
  --brand-strong: var(--brand-700);

  --header-grad-a: #64748b;
  --header-grad-b: #334155;

  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;

  --border-color: #e5e7eb;
}

/* 主题：Emerald（清新绿） */
.theme-emerald {
  --brand-50:  #ecfdf5;
  --brand-100: #d1fae5;
  --brand-400: #34d399;
  --brand-600: #10b981;
  --brand-700: #059669;

  --brand: var(--brand-600);
  --brand-weak: var(--brand-100);
  --brand-strong: var(--brand-700);

  --header-grad-a: #6ee7b7;
  --header-grad-b: #10b981;

  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;

  --border-color: #dcfce7;
}

/* 边框风格预设（可叠加在主题上） */
.border-dashed { --border-style: dashed; --border-width: 2px; }
.border-dotted { --border-style: dotted; --border-width: 2px; }
.border-strong { --border-width: 2px; --shadow: 0 12px 36px rgba(0,0,0,.14); }
.radius-minimal { --radius-md: 8px; --radius-xl: 12px; --radius-2xl: 14px; }
.radius-soft    { --radius-md: 14px; --radius-xl: 18px; --radius-2xl: 22px; }

/* =================================================================== */
/* Element Plus 主题变量（和品牌主色联动）                              */
/* =================================================================== */
:root,
.theme-slate,
.theme-emerald {
  --el-color-primary: var(--brand);
  --el-color-primary-dark-2: var(--brand-700);
  --el-menu-hover-bg-color: color-mix(in srgb, var(--brand) 12%, white);

  --el-menu-item-height: 52px;
  --el-menu-sub-item-height: 48px;
  --el-menu-horizontal-height: 56px;
  --el-menu-horizontal-sub-item-height: 40px;
  --el-menu-item-font-size: var(--el-font-size-base);
  --el-menu-active-color: var(--el-color-primary);
  --el-menu-text-color: var(--el-text-color-primary);
  --el-menu-hover-text-color: var(--el-color-primary);
  --el-menu-bg-color: transparent !important;
  --el-menu-item-hover-fill: var(--el-color-primary-light-9);
  --el-menu-border-color: var(--el-border-color);
  --el-menu-base-level-padding: 16px;
  --el-menu-level-padding: 16px;
}

/* =================================================================== */
/* 语义变量 + 强制浅色主题                                              */
/* =================================================================== */
:root {
  --color-background: var(--vt-c-white);
  --color-background-soft: var(--vt-c-white-soft);
  --color-background-mute: var(--vt-c-white-mute);
  --color-border: var(--vt-c-divider-light-2);
  --color-border-hover: var(--vt-c-divider-light-1);
  --color-heading: var(--vt-c-text-light-1);
  --color-text: var(--vt-c-text-light-1);

  --section-gap: 160px;

  /* 布局 */
  --header-h: 64px;
  --aside-w: clamp(220px, 18vw, 300px); /* 自适应侧栏宽度 */
}

/* 强制浅色（不随系统/类名切换） */
@media (prefers-color-scheme: dark), (prefers-color-scheme: light) {
  :root {
    --color-background: var(--vt-c-white) !important;
    --color-background-soft: var(--vt-c-white-soft) !important;
    --color-background-mute: var(--vt-c-white-mute) !important;
    --color-border: var(--vt-c-divider-light-2) !important;
    --color-border-hover: var(--vt-c-divider-light-1) !important;
    --color-heading: var(--vt-c-text-light-1) !important;
    --color-text: var(--vt-c-text-light-1) !important;
  }
}
html.dark, :root.dark, :root[data-theme="dark"], body.dark {
  --color-background: var(--vt-c-white) !important;
  --color-background-soft: var(--vt-c-white-soft) !important;
  --color-background-mute: var(--vt-c-white-mute) !important;
  --color-border: var(--vt-c-divider-light-2) !important;
  --color-border-hover: var(--vt-c-divider-light-1) !important;
  --color-heading: var(--vt-c-text-light-1) !important;
  --color-text: var(--vt-c-text-light-1) !important;
}

/* =================================================================== */
/* App 根节点与通用元素                                                 */
/* =================================================================== */
#app {
  height: 100%;
  width: 100%;
  margin: 0 auto;
  padding: 0;
  color: var(--color-text);
  background-image:
    linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.88)),
    url('../assets/background.jpg');
  background-size: cover;
  background-attachment: fixed;
}

/* 链接 */
a,
.green {
  text-decoration: none;
  color: hsla(160, 100%, 37%, 1);
  transition: color .2s, background-color .2s, box-shadow .2s;
  padding: 3px 5px;
  border-radius: 6px;
}
a:hover,
.green:hover {
  background-color: hsla(160, 100%, 37%, .14);
  box-shadow: 0 2px 8px rgba(0,0,0,.12);
  color: hsla(160, 100%, 42%, 1);
}

/* 大屏基调 */
@media (min-width: 1024px) {
  body { display: block; background: var(--color-background-soft); }
}

/* =================================================================== */
/* 布局：.app-shell / .app-header / .app-body                           */
/* =================================================================== */
.app-shell { min-height: 100vh; }

/* 顶部栏 */
.app-header {
  height: var(--header-h);
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(145deg, var(--header-grad-a), var(--header-grad-b));
  color: #fff;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow);
  margin: 16px;
  padding: .75rem 1rem;
  position: sticky;
  top: 0;
  z-index: 10;
  font-size: 22px;
  font-weight: 600;
}

/* 身体：侧栏 + 主区 */
.app-body {
  display: grid;
  grid-template-columns: var(--aside-w) 1fr;
  gap: 12px;
  align-items: stretch;
  min-height: calc(100vh - var(--header-h) - 32px);
  padding: 10px 16px 16px;
}

/* =================================================================== */
/* 容器：Aside/Main（不固定高度，自适应 + 内部滚动）                     */
/* =================================================================== */
.app-aside,
.el-aside,
.el-main {
  background: var(--panel-bg);
  border: var(--border-width) var(--border-style) var(--border-color);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-soft);
  margin: 0;
  padding: 1.25rem;
  transition: transform .2s ease;
  min-height: 0;        /* 让子元素滚动生效 */
  overflow: hidden auto;/* 自身滚动 */
}
.el-aside:hover, .el-main:hover { transform: translateY(-1px); }

/* =================================================================== */
/* 侧栏：头像区 + 菜单（菜单内部滚动，而非计算密度）                    */
/* =================================================================== */
.app-aside {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
}
.profile {
  position: sticky;
  top: 0;
  z-index: 1;
  background: var(--panel-bg-strong);
  border: var(--border-width) var(--border-style) var(--border-color);
  border-radius: var(--radius-md);
  padding: 14px 10px;
  text-align: center;
  box-shadow: var(--shadow-soft);
}
.profile .el-avatar { box-shadow: 0 8px 20px color-mix(in srgb, var(--brand) 28%, transparent); margin-bottom: 8px; }
.profile-name { font-weight: 700; color: #0f172a; }

/* 菜单容器：充满剩余空间并滚动 */
.app-menu {
  flex: 1;
  min-height: 0;
  width: 100%;
  overflow: auto;
  background: transparent;
  border-right: 0 !important;
  padding: 6px 2px;
}

/* 菜单项视觉 */
.el-menu {
  width: 100%;
  background: transparent;
  border-right: 0 !important;
}
.el-menu-item {
  font-size: 14px !important;
  justify-content: center !important;
  color: #334155;
  background-color: var(--brand-50);
  padding: 0 .75rem;
  height: var(--el-menu-item-height) !important;
  border-radius: 10px;
  border: var(--border-width) var(--border-style) var(--border-color);
  font-weight: 600;
  box-shadow: 0 2px 5px rgba(0,0,0,.06);
  transition: background-color .2s, color .2s, box-shadow .2s, transform .15s ease;
  margin: 6px 0;
}
.el-menu-item:hover {
  background-color: var(--el-menu-hover-bg-color);
  color: var(--el-color-primary);
  box-shadow: 0 6px 16px color-mix(in srgb, var(--brand) 24%, transparent);
  transform: translateX(1px);
}
.el-menu-item.is-active {
  background: linear-gradient(90deg, var(--header-grad-a), var(--header-grad-b));
  color: #fff !important;
  border-color: transparent;
  box-shadow: 0 10px 24px color-mix(in srgb, var(--brand) 32%, transparent);
}

/* =================================================================== */
/* 主内容区                                                              */
/* =================================================================== */
.app-main,
.el-main {
  padding: 24px;
}

/* 行/按钮细节 */
.el-row { margin-top: 10px; }
button, .el-button-group .el-button {
  transition: background-color .2s, box-shadow .2s, transform .15s;
}
button:hover, .el-button-group .el-button:hover {
  background-color: var(--el-color-primary);
  color: #fff;
  box-shadow: 0 8px 18px rgba(0,0,0,.16);
  transform: translateY(-1px);
}

/* =================================================================== */
/* 滚动条美化                                                           */
/* =================================================================== */
.el-aside::-webkit-scrollbar,
.el-main::-webkit-scrollbar,
.app-menu::-webkit-scrollbar { width: 10px; height: 10px; }
.el-aside::-webkit-scrollbar-thumb,
.el-main::-webkit-scrollbar-thumb,
.app-menu::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--header-grad-a), var(--header-grad-b));
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
.el-aside::-webkit-scrollbar-track,
.el-main::-webkit-scrollbar-track,
.app-menu::-webkit-scrollbar-track { background: transparent; }

/* =================================================================== */
/* 响应式：收窄侧栏/改堆叠                                              */
/* =================================================================== */
@media (max-width: 1200px) {
  :root { --aside-w: 220px; }
}
@media (max-width: 992px) {
  .app-body { grid-template-columns: 1fr; }
  .app-aside { position: sticky; top: calc(var(--header-h) + 8px); z-index: 9; }
}
@media (max-width: 768px) {
  :root { --aside-w: 100%; }
  .app-header { margin: 10px; border-radius: 12px; }
  .app-aside, .el-main { padding: 1rem; border-radius: 12px; }
  .el-menu-item { font-size: 13px !important; height: 46px !important; }
}
/* === Fix: 只菜单和主区滚动，补齐高度链 === */

/* 页面根不滚动 */
html, body, #app { height: 100%; }
body { overflow: hidden; }

/* 外壳用列方向，头部固定高，主体填满 */
.app-shell {
  height: 100vh;           /* 明确视口高度 */
  display: flex;
  flex-direction: column;
}

/* 头部固定高度；避免外边距撑高整体 */
.app-header {
  flex: 0 0 var(--header-h);
  margin: 8px 16px 8px;
  position: sticky;
  top: 0;
  z-index: 10;
}

/* 主体必须有确定高度+截断滚动，交给子元素滚 */
.app-body {
  flex: 1 1 auto;
  min-height: 0;                     /* 关键：允许子级滚动 */
  height: calc(100vh - var(--header-h) - 16px); /* 明确高度（含 header 外边距） */
  overflow: hidden;                  /* 关键：不要让整个页面滚 */
  display: grid;
  grid-template-columns: var(--aside-w) 1fr;
  gap: 12px;
  padding: 0 16px 16px;
}

/* 侧栏/主区都要有可滚动的子级，因此自己先不滚，保持高度闭合 */
.app-aside,
.el-aside,
.app-main,
.el-main {
  height: 100%;      /* 继承 app-body 的高度 */
  min-height: 0;     /* 关键：允许内部滚动 */
  overflow: hidden;  /* 自己不滚，交给内部滚 */
}

/* 头像区 sticky，菜单占满剩余高度并滚动 */
.profile {
  position: sticky;
  top: 0;
  z-index: 1;
}
.app-menu {
  flex: 1 1 auto;
  min-height: 0;     /* 关键：让滚动真正生效 */
  overflow: auto;    /* 只有菜单滚动 */
  width: 100%;
}

/* 主内容区内部滚动 */
.app-main > *,
.el-main > * {
  min-height: 0;
}
.el-main {
  overflow: auto;    /* 只有主区滚动 */
}

/* 小屏保持内部滚动模型 */
@media (max-width: 992px) {
  .app-body { grid-template-columns: 1fr; }
  .app-aside { position: sticky; top: calc(var(--header-h) + 8px); z-index: 9; }
}
