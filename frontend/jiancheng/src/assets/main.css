/* =================================================================== */
/* main.css — 统一浅色主题 + 通用布局 + Element Plus 适配               */
/* =================================================================== */

/* 先引入基础样式（变量/排版/组件统一） */
@import './base.css';

/* =================================================================== */
/* 主题色板与基础变量                                                   */
/* =================================================================== */

:root {
  --vt-c-white: #ffffff;
  --vt-c-white-soft: #f8f8f8;
  --vt-c-white-mute: #f2f2f2;

  --vt-c-black: #181818;
  --vt-c-black-soft: #222222;
  --vt-c-black-mute: #282828;

  --vt-c-indigo: #2c3e50;

  --vt-c-divider-light-1: rgba(60, 60, 60, 0.29);
  --vt-c-divider-light-2: rgba(60, 60, 60, 0.12);
  --vt-c-divider-dark-1: rgba(84, 84, 84, 0.65);
  --vt-c-divider-dark-2: rgba(84, 84, 84, 0.48);

  --vt-c-text-light-1: var(--vt-c-indigo);
  --vt-c-text-light-2: rgba(60, 60, 60, 0.66);
  --vt-c-text-dark-1: var(--vt-c-white);
  --vt-c-text-dark-2: rgba(235, 235, 235, 0.86);
}

/* === 主题&边框变量（默认：Ocean） === */
:root {
  --brand-50:  #eff6ff;
  --brand-100: #dbeafe;
  --brand-200: #bfdbfe;
  --brand-400: #60a5fa;
  --brand-600: #2193b0;
  --brand-700: #1d4ed8;

  --brand:        var(--brand-600);
  --brand-weak:   var(--brand-100);
  --brand-strong: var(--brand-700);

  --header-grad-a: #6dd5ed;
  --header-grad-b: #2193b0;

  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;

  --border-color: #e5e7eb;
  --border-style: solid;
  --border-width: 1px;
  --radius-md: 12px;
  --radius-xl: 16px;
  --radius-2xl: 20px;

  --shadow-soft: 0 6px 16px rgba(0,0,0,.08);
  --shadow:      0 10px 30px rgba(0,0,0,.12);
}

/* 主题：Slate（中性灰蓝） */
.theme-slate {
  --brand-50:  #eef2ff;
  --brand-100: #e2e8f0;
  --brand-400: #94a3b8;
  --brand-600: #475569;
  --brand-700: #334155;

  --brand: var(--brand-600);
  --brand-weak: var(--brand-100);
  --brand-strong: var(--brand-700);

  --header-grad-a: #64748b;
  --header-grad-b: #334155;
  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;
  --border-color: #e5e7eb;
}

/* 主题：Emerald（清新绿） */
.theme-emerald {
  --brand-50:  #ecfdf5;
  --brand-100: #d1fae5;
  --brand-400: #34d399;
  --brand-600: #10b981;
  --brand-700: #059669;

  --brand: var(--brand-600);
  --brand-weak: var(--brand-100);
  --brand-strong: var(--brand-700);

  --header-grad-a: #6ee7b7;
  --header-grad-b: #10b981;

  --panel-bg: #ffffff;
  --panel-bg-strong: #ffffff;
  --border-color: #dcfce7;
}

/* 边框风格预设 */
.border-dashed { --border-style: dashed; --border-width: 2px; }
.border-dotted { --border-style: dotted; --border-width: 2px; }
.border-strong { --border-width: 2px; --shadow: 0 12px 36px rgba(0,0,0,.14); }
.radius-minimal { --radius-md: 8px; --radius-xl: 12px; --radius-2xl: 14px; }
.radius-soft    { --radius-md: 14px; --radius-xl: 18px; --radius-2xl: 22px; }

/* =================================================================== */
/* Element Plus 主题变量（和品牌主色联动）                              */
/* =================================================================== */
:root,
.theme-slate,
.theme-emerald {
  --el-color-primary: var(--brand);
  --el-color-primary-dark-2: var(--brand-700);
  --el-menu-hover-bg-color: color-mix(in srgb, var(--brand) 12%, white);

  --el-menu-item-height: 52px;
  --el-menu-sub-item-height: 48px;
  --el-menu-active-color: var(--el-color-primary);
  --el-menu-text-color: var(--el-text-color-primary);
  --el-menu-hover-text-color: var(--el-color-primary);
  --el-menu-bg-color: transparent !important;
  --el-menu-item-hover-fill: var(--el-color-primary-light-9);
  --el-menu-border-color: var(--el-border-color);
}

/* =================================================================== */
/* 语义变量 + 强制浅色主题                                              */
/* =================================================================== */
:root {
  --color-background: var(--vt-c-white);
  --color-background-soft: var(--vt-c-white-soft);
  --color-background-mute: var(--vt-c-white-mute);
  --color-border: var(--vt-c-divider-light-2);
  --color-heading: var(--vt-c-text-light-1);
  --color-text: var(--vt-c-text-light-1);

  --section-gap: 160px;
  --header-h: 64px;
  --aside-w: clamp(220px, 10vw, 300px);
}

/* =================================================================== */
/* App 根节点与通用元素                                                 */
/* =================================================================== */
#app {
  height: 100%;
  width: 100%;
  color: var(--color-text);
  background-image:
    linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.88)),
    url('../assets/background.jpg');
  background-size: cover;
  background-attachment: fixed;
}

/* =================================================================== */
/* 布局：.app-shell / .app-header / .app-body                           */
/* =================================================================== */
.app-shell {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* 顶部栏 */
.app-header {
  flex: 0 0 var(--header-h);
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(145deg, var(--header-grad-a), var(--header-grad-b));
  color: #fff;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow);
  margin: 8px 16px;
  font-size: 22px;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 10;
}

/* 主体 */
.app-body {
  flex: 1 1 auto;
  min-height: 0;
  height: calc(100vh - var(--header-h) - 16px);
  overflow: hidden;
  display: grid;
  grid-template-columns: var(--aside-w) 1fr;
  gap: 12px;
  padding: 0 16px 16px;
}

/* =================================================================== */
/* 侧栏 + 主区样式                                                      */
/* =================================================================== */
.app-aside,
.el-aside,
.el-main {
  background: var(--panel-bg);
  border: var(--border-width) var(--border-style) var(--border-color);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-soft);
  padding: 1.25rem;
  transition: box-shadow .2s ease;
  height: 100%;
  min-height: 0;
  overflow: hidden;
  transform: none !important; /* 防止 containing block 影响 fixed */
}
.el-aside:hover, .el-main:hover {
  box-shadow: 0 8px 22px rgba(0,0,0,.12);
}

/* =================================================================== */
/* 侧栏：头像区 + 菜单                                                  */
/* =================================================================== */
.app-aside {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
}
.profile {
  position: sticky;
  top: 0;
  background: var(--panel-bg-strong);
  border-radius: var(--radius-md);
  padding: 14px 10px;
  text-align: center;
  box-shadow: var(--shadow-soft);
}
.profile .el-avatar {
  box-shadow: 0 8px 20px color-mix(in srgb, var(--brand) 28%, transparent);
  margin-bottom: 8px;
}
.profile-name { font-weight: 700; color: #0f172a; }

.app-menu {
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;
  width: 100%;
  padding: 6px 2px;
}

/* 菜单项 */
.el-menu {
  width: 100%;
  background: transparent;
  border-right: 0 !important;
}
.el-menu-item {
  font-size: 14px !important;
  color: #334155;
  background-color: var(--brand-50);
  padding: 0 .75rem;
  height: var(--el-menu-item-height) !important;
  border-radius: 10px;
  border: var(--border-width) var(--border-style) var(--border-color);
  font-weight: 600;
  box-shadow: 0 2px 5px rgba(0,0,0,.06);
  transition: all .2s ease;
  margin: 6px 0;
}
.el-menu-item:hover {
  background-color: var(--el-menu-hover-bg-color);
  color: var(--el-color-primary);
  box-shadow: 0 6px 16px color-mix(in srgb, var(--brand) 24%, transparent);
}
.el-menu-item.is-active {
  background: linear-gradient(90deg, var(--header-grad-a), var(--header-grad-b));
  color: #fff !important;
  border-color: transparent;
  box-shadow: 0 10px 24px color-mix(in srgb, var(--brand) 32%, transparent);
}

/* =================================================================== */
/* 主内容区                                                             */
/* =================================================================== */
.app-main, .el-main {
  padding: 24px;
  overflow: auto;
}

/* =================================================================== */
/* 滚动条美化                                                           */
/* =================================================================== */
.el-aside::-webkit-scrollbar,
.el-main::-webkit-scrollbar,
.app-menu::-webkit-scrollbar { width: 10px; height: 10px; }
.el-aside::-webkit-scrollbar-thumb,
.el-main::-webkit-scrollbar-thumb,
.app-menu::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--header-grad-a), var(--header-grad-b));
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

/* =================================================================== */
/* Dialog 全屏修复（关键部分）                                          */
/* =================================================================== */
.el-overlay,
.el-overlay-dialog,
.el-overlay-message {
  position: fixed !important;
  inset: 0 !important;
  z-index: 3000 !important;
}
.el-overlay .el-dialog {
  margin: auto !important;
}
.el-overlay .el-drawer {
  position: fixed !important;
  inset: 0 auto 0 0;
  z-index: 3001 !important;
}

/* =================================================================== */
/* 响应式                                                               */
/* =================================================================== */
@media (max-width: 1200px) {
  :root { --aside-w: 220px; }
}
@media (max-width: 992px) {
  .app-body { grid-template-columns: 1fr; }
  .app-aside { position: sticky; top: calc(var(--header-h) + 8px); z-index: 9; }
}
@media (max-width: 768px) {
  :root { --aside-w: 100%; }
  .app-header { margin: 10px; border-radius: 12px; }
  .app-aside, .el-main { padding: 1rem; border-radius: 12px; }
  .el-menu-item { font-size: 13px !important; height: 46px !important; }
}
/* ============================== */
/* Fix: 下拉类 Popper 被裁切/遮挡  */
/* ============================== */

/* 1) 主体容器不再裁切后代（让下拉层可溢出显示） */
.app-body {
  overflow: visible !important;
}

/* 2) 统一抬升 Popper 层级（Select / DatePicker / Dropdown / Tooltip 等） */
.el-popper,
.el-select__popper,
.el-picker__popper,
.el-dropdown__popper,
.el-tooltip__popper,
.el-cascader__dropdown,
.el-color-dropdown {
  z-index: 3100 !important; /* 高于对话框遮罩(3000) */
}

/* 3) 兜底：确保 popper 在 body 下时不被其他元素影响 */
.el-popper.is-pure,
.el-popper {
  /* 保持 EP 的 absolute，由定位引擎控制，不改为 fixed */
  position: absolute;
  /* 避免外层意外的 transform 影响（已在容器处清理 transform） */
  transform: none !important;
}

/* 如果你的某些下拉是放在容器内而非 Teleport 到 body：
   让侧栏/主区“自己不滚，给内部内容滚动”，减少裁切几率 */
.app-aside,
.el-aside,
.el-main {
  overflow: hidden;     /* 自身不滚动 */
}
.el-main {
  overflow: auto;       /* 仅主区内容滚动 */
}

/* 仍然保留对话框的全屏 fixed 修复，无需修改 */

/* ========================================================= */
/* Fix 1: 菜单文字不居中                                     */
/* 让 el-menu-item 双轴居中，兼容带图标或纯文字的场景         */
/* ========================================================= */
.el-menu-item {
  display: flex !important;
  align-items: center !important;   /* 垂直居中 */
  justify-content: center !important; /* 水平居中 */
  line-height: normal !important;   /* 避免行高影响垂直对齐 */
  padding-left: 0 !important;       /* 居中对齐时去掉多余左内边距 */
  padding-right: 0 !important;
  text-align: center !important;
}

/* 若菜单有图标，给文字留点间距（无图标时无影响） */
.el-menu-item .el-icon + span,
.el-menu-item [class*="el-icon"] + span {
  margin-left: 8px;
}

/* 子菜单箭头与内容居中时的对齐微调（如后续用到 SubMenu 可保留） */
.el-sub-menu__title {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  line-height: normal !important;
  text-align: center !important;
}
.el-sub-menu__title .el-sub-menu__icon-arrow {
  margin-left: 6px;
}

/* ========================================================= */
/* Fix 2: 按钮颜色统一为“登录按钮品牌渐变”                   */
/* 让所有 primary 按钮与 .button-large 使用同一条渐变色       */
/* ========================================================= */

/* 统一定义品牌渐变变量（与 .button-large 相同的两端色） */
:root {
  --brand-gradient: linear-gradient(90deg, var(--header-grad-a), var(--header-grad-b));
  --brand-shadow: 0 8px 18px rgba(33,147,176,.25);
  --brand-shadow-hover: 0 12px 24px rgba(33,147,176,.32);
}

/* 基础按钮外观（圆角/动效与现有保持一致） */
.el-button {
  border-radius: 5px;
}
.vxe-button {
  background: #2193b0 !important;
  border-color: transparent !important;
  color: #fff !important;
  box-shadow: var(--brand-shadow);
}

/* 主按钮（primary）改用品牌渐变（和 .button-large 完全一致） */
.el-button--primary {
  background: #2193b0 !important;
  border-color: transparent !important;
  color: #fff !important;
  box-shadow: var(--brand-shadow);
}

/* 悬浮/按下态与 .button-large 保持一致 */
.el-button--primary:hover,
.el-button--primary:focus-visible {
  filter: brightness(1.02);
  transform: translateY(-1px);
  box-shadow: var(--brand-shadow-hover);
}
.el-button--primary:active {
  transform: translateY(0);
  filter: brightness(.98);
  box-shadow: var(--brand-shadow);
}

/* 禁用态：柔和一些，禁用交互阴影与动画 */
.el-button--primary.is-disabled,
.el-button--primary.is-disabled:hover,
.el-button--primary.is-disabled:focus,
.el-button--primary.is-disabled:active {
  background: #2193b0 !important;
  opacity: .55;
  box-shadow: none;
  transform: none;
  filter: none;
}

/* 保持自定义 .button-large 与主按钮风格一致（无需改动你的原样式） */
.button-large {
  height: 48px;
  width: 100%;
  border-radius: 2px;
  background: var(--brand-gradient);
  border: none;
  font-weight: 800;
  letter-spacing: .4px;
  color: #fff;
  box-shadow: var(--brand-shadow);
  transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
}
.button-large:hover {
  transform: translateY(-1px);
  filter: brightness(1.02);
  box-shadow: var(--brand-shadow-hover);
}
.button-large:active {
  transform: translateY(0);
  filter: brightness(.98);
}

.el-aside {
  --el-aside-width: var(--aside-w) !important;       /* 一些主题用这个变量 */
  width: var(--aside-w) !important;                  /* 主宽度 */
  min-width: var(--aside-w) !important;              /* 防止被收缩 */
  max-width: var(--aside-w) !important;              /* 防止被撑开 */
  box-sizing: border-box;
}